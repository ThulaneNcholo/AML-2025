{% load static %}
<section id="scroll-anchor" class="page_heading">
  <center>
    <h1 class="fw-bold text-uppercase text-light mb-3">Admin Dashboard</h1>
    <div class="container">
      <hr class="bg-light" />
    </div>
  </center>
</section>

<section class="container">
  <center>
    <h3 class="fw-bold mb-3">{{users_count}} - Registrations</h3>
    <p id="downloadNotice" style="display: none; color: green">
      Your download is starting...
    </p>
  </center>
  <div class="row d-flex justify-content-center">
    <div class="col-12 col-md-6 col-lg-4">
      <button class="btn btn-dark primary_btn mb-5" onclick="startDownload()">
        Download
      </button>
    </div>
  </div>
  <ul class="list-group list-group-flush">
    <li class="list-group-item py-3">
      <div class="row">
        <div class="col">
          <h6 class="table_titles mb-0">Name</h6>
        </div>
        <div class="col">
          <h6 class="table_titles mb-0">Plan</h6>
        </div>
        <div class="col d-none d-md-block">
          <h6 class="table_titles mb-0">Contact</h6>
        </div>
        <div class="col d-none d-md-block">
          <h6 class="table_titles mb-0">Email</h6>
        </div>
        <div class="col d-none d-md-block">
          <h6 class="table_titles mb-0">Company</h6>
        </div>
        <div class="col d-none d-md-block">
          <h6 class="table_titles mb-0">Position</h6>
        </div>
        <div class="col-1 d-none d-md-block">
          <h6 class="table_titles mb-0">Dietary</h6>
        </div>
        <div class="col-1 d-none d-md-block">
          <h6 class="table_titles mb-0">Dietary(Other)</h6>
        </div>
      </div>
    </li>
    {% for data in users %}
    <li class="list-group-item py-3">
      <div class="row">
        <div class="col">
          <p class="mb-0">{{forloop.counter}} - {{data.FullName}}</p>
        </div>
        <div class="col">
          <p class="mb-0">{{data.plans}}</p>
        </div>
        <div class="col d-none d-md-block">
          <p class="mb-0">{{data.contact}}</p>
        </div>
        <div class="col d-none d-md-block">
          <p class="mb-0">{{data.email}}</p>
        </div>
        <div class="col d-none d-md-block">
          <p class="mb-0">{{data.company}}</p>
        </div>
        <div class="col d-none d-md-block">
          <p class="mb-0">{{data.position}}</p>
        </div>
        <div class="col-1 d-none d-md-block">
          <p class="mb-0">{{data.dietary}}</p>
        </div>
        <div class="col-1 d-none d-md-block">
          <p class="mb-0">{{data.other_diet}}</p>
        </div>
      </div>
    </li>
    {% empty %}
    <li class="list-group-item py-3">
      <div class="row">
        <div class="col-12">
          <p class="mb-0">You currently has no registration</p>
        </div>
      </div>
    </li>
    {% endfor %}
  </ul>
</section>

<script>
  function startDownload() {
    // Optional: show a non-blocking message
    document.getElementById("downloadNotice").style.display = "block";
    // Trigger download
    window.location.href = "{% url 'download-csv' %}";
  }
</script>
